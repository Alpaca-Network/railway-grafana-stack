# ============================================================
# ABNORMAL BEHAVIOR ALERTING - Environment Configuration
# ============================================================
# Copy this to .env and fill in your values
# Set these in Railway project settings for production

# ============================================================
# SMTP EMAIL CONFIGURATION
# ============================================================
# Gmail requires an "App Password" if 2FA is enabled
# Generate at: https://myaccount.google.com/apppasswords

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=alerts@gatewayz.ai
SMTP_PASSWORD=your-gmail-app-password-here
SMTP_FROM_EMAIL=alerts@gatewayz.ai
SMTP_FROM_NAME="GatewayZ Alerts"

# ============================================================
# OBSERVATORY POOL - EMAIL RECIPIENTS
# ============================================================
# Comma-separated list of email addresses for alert notifications
# These users will receive all abnormal behavior alerts

# Critical Alerts - Immediate attention required
OBSERVATORY_POOL_CRITICAL=user1@company.com,user2@company.com,oncall@company.com

# Warning Alerts - Attention needed soon
OBSERVATORY_POOL_WARNING=user1@company.com,user2@company.com,user3@company.com

# Info/Digest - Daily summary emails
OBSERVATORY_POOL_DIGEST=team@company.com,monitoring@company.com

# ============================================================
# ALERT THRESHOLDS (Optional - Defaults provided)
# ============================================================
# Adjust these values to tune alert sensitivity

# Traffic Spike Detection
TRAFFIC_SPIKE_MULTIPLIER=2.0          # Alert when traffic is 2x+ baseline
TRAFFIC_SPIKE_DURATION=10m            # Must persist for 10 minutes

# Error Rate Thresholds
ERROR_RATE_CRITICAL_PERCENT=10        # Critical at 10% error rate
ERROR_RATE_WARNING_PERCENT=5          # Warning at 5% error rate
ERROR_RATE_MULTIPLIER=3               # Alert when 3x baseline

# Latency Thresholds
LATENCY_CRITICAL_MULTIPLIER=2.0       # Critical when 2x+ baseline
LATENCY_WARNING_MULTIPLIER=1.5        # Warning when 1.5x+ baseline
LATENCY_ABSOLUTE_THRESHOLD=1.0        # Must exceed 1 second

# Availability Thresholds
AVAILABILITY_CRITICAL_PERCENT=90      # Critical below 90%
AVAILABILITY_WARNING_PERCENT=95       # Warning below 95%

# ============================================================
# NOTIFICATION TIMING
# ============================================================
# Control how frequently alerts are sent

# Critical alerts repeat every 15 minutes if unresolved
CRITICAL_REPEAT_INTERVAL=15m

# Warning alerts repeat every 1 hour if unresolved  
WARNING_REPEAT_INTERVAL=1h

# Info alerts sent once per day
INFO_REPEAT_INTERVAL=24h

# Group similar alerts within this window
ALERT_GROUP_INTERVAL=5m

# ============================================================
# RAILWAY DEPLOYMENT
# ============================================================
# Set these in Railway project settings:
# 1. Go to your Railway project
# 2. Select the railway-grafana-stack service
# 3. Go to Variables tab
# 4. Add each variable above
# 5. Redeploy the service

# ============================================================
# TESTING
# ============================================================
# Test email delivery with:
# docker-compose exec prometheus amtool alert add test_alert severity=critical
