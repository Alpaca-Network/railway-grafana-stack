apiVersion: 1

datasources:
  - name: Prometheus
    uid: grafana_prometheus  # Fixed UID to match dashboard references
    type: prometheus
    access: proxy
    url: ${PROMETHEUS_INTERNAL_URL:-http://prometheus:9090}
    isDefault: true
    editable: true
    jsonData:
      timeInterval: 15s
      # Exemplar configuration: link trace_id exemplars to Tempo traces.
      # When a Prometheus histogram/counter carries a trace_id exemplar,
      # Grafana renders a clickable diamond that opens the trace in Tempo.
      exemplarTraceIdDestinations:
        - name: trace_id
          datasourceUid: grafana_tempo
