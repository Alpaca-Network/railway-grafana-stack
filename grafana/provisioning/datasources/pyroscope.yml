apiVersion: 1

datasources:
  # Self-hosted Pyroscope — continuous profiling for gatewayz-backend.
  #
  # Pyroscope runs as a service inside the Railway project (same project as Grafana).
  # The backend pushes CPU/memory flamegraph samples to it via internal DNS.
  # Grafana reads those profiles back through this datasource.
  #
  # Internal URLs:
  #   Railway:       http://pyroscope.railway.internal:4040
  #   docker-compose: http://pyroscope:4040  (Docker service name)
  #
  # No authentication is required — port 4040 is internal only and never
  # exposed publicly in the Railway project.
  #
  # Railway env var to set on the Grafana service:
  #   PYROSCOPE_INTERNAL_URL=http://pyroscope.railway.internal:4040
  - name: Pyroscope
    uid: grafana_pyroscope
    type: grafana-pyroscope-datasource   # built-in in Grafana 10+, no plugin needed
    access: proxy
    url: ${PYROSCOPE_INTERNAL_URL:-http://pyroscope:4040}
    isDefault: false
    editable: true
