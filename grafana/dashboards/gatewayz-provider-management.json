{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "panels": [],
      "title": "Provider Statistics Overview",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 0,
        "y": 1
      },
      "id": 2,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "text": {},
        "textMode": "auto"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_total",
          "refId": "A"
        }
      ],
      "title": "Total Providers",
      "type": "stat"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 6,
        "y": 1
      },
      "id": 3,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "text": {},
        "textMode": "auto"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_active",
          "refId": "A"
        }
      ],
      "title": "Active Providers",
      "type": "stat"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "orange",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 1
      },
      "id": 4,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "text": {},
        "textMode": "auto"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_inactive",
          "refId": "A"
        }
      ],
      "title": "Inactive Providers",
      "type": "stat"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 1
      },
      "id": 5,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "text": {},
        "textMode": "auto"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_healthy",
          "refId": "A"
        }
      ],
      "title": "Healthy Providers",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 9
      },
      "id": 6,
      "panels": [],
      "title": "Provider Health Status",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 10
      },
      "id": 7,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "pieType": "pie"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_by_health_status",
          "format": "heatmap",
          "instant": false,
          "refId": "A"
        }
      ],
      "title": "Providers by Health Status",
      "type": "piechart"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 10
      },
      "id": 8,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "pieType": "pie"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_by_status",
          "format": "heatmap",
          "instant": false,
          "refId": "A"
        }
      ],
      "title": "Providers by Active Status",
      "type": "piechart"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 18
      },
      "id": 9,
      "panels": [],
      "title": "Provider Performance Metrics",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "Response Time (ms)",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 19
      },
      "id": 10,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single"
        }
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_provider_response_time_ms",
          "legendFormat": "{{provider}}",
          "refId": "A"
        }
      ],
      "title": "Average Response Time by Provider",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 27
      },
      "id": 11,
      "panels": [],
      "title": "Provider Capabilities",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 0,
        "y": 28
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "pieType": "pie"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_with_streaming",
          "refId": "A"
        }
      ],
      "title": "Streaming Support",
      "type": "piechart"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 6,
        "y": 28
      },
      "id": 13,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "pieType": "pie"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_with_function_calling",
          "refId": "A"
        }
      ],
      "title": "Function Calling Support",
      "type": "piechart"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 28
      },
      "id": 14,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "pieType": "pie"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_with_vision",
          "refId": "A"
        }
      ],
      "title": "Vision Support",
      "type": "piechart"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 28
      },
      "id": 15,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "pieType": "pie"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_providers_with_image_generation",
          "refId": "A"
        }
      ],
      "title": "Image Generation Support",
      "type": "piechart"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 36
      },
      "id": 16,
      "panels": [],
      "title": "Provider Details Table",
      "type": "row"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "displayMode": "auto"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Health Status"
            },
            "properties": [
              {
                "id": "custom.displayMode",
                "value": "color-background"
              },
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 24,
        "x": 0,
        "y": 37
      },
      "id": 17,
      "options": {
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "gatewayz_provider_info",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "title": "All Providers",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "indexByName": {},
            "renameByName": {
              "provider": "Provider Name",
              "health_status": "Health Status",
              "is_active": "Active",
              "response_time_ms": "Response Time (ms)",
              "last_health_check_at": "Last Health Check"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 49
      },
      "id": 18,
      "panels": [],
      "title": "API Endpoint Specifications",
      "type": "row"
    },
    {
      "datasource": null,
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 50
      },
      "id": 19,
      "options": {
        "content": "## GET /providers\n\n**Returns:** Array of all providers with full details\n\n**Authentication:** Bearer token in Authorization header\n\n**Response Fields:**\n- `id` - Unique provider identifier\n- `name` - Human-readable name (e.g., \"OpenAI\")\n- `slug` - URL-friendly identifier (e.g., \"openai\")\n- `is_active` - Whether provider is currently active\n- `health_status` - Current status: healthy, degraded, down, unknown\n- `average_response_time_ms` - Response time in milliseconds\n- `supports_streaming` - Boolean\n- `supports_function_calling` - Boolean\n- `supports_vision` - Boolean\n- `supports_image_generation` - Boolean\n- `last_health_check_at` - ISO 8601 timestamp\n- `created_at` - ISO 8601 timestamp\n- `updated_at` - ISO 8601 timestamp\n\n**Example Request:**\n```bash\ncurl -H \"Authorization: Bearer YOUR_ADMIN_KEY\" \\\n  https://api.gatewayz.ai/providers\n```",
        "mode": "markdown"
      },
      "pluginVersion": "8.0.0",
      "title": "GET /providers Endpoint",
      "type": "text"
    },
    {
      "datasource": null,
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 50
      },
      "id": 20,
      "options": {
        "content": "## GET /providers/stats\n\n**Returns:** Aggregated statistics about all providers\n\n**Authentication:** Bearer token in Authorization header\n\n**Response Fields:**\n- `total` - Total number of providers\n- `active` - Number of active providers\n- `inactive` - Number of inactive providers\n- `healthy` - Number of healthy providers\n- `degraded` - Number of degraded providers\n- `down` - Number of down providers\n- `unknown` - Number with unknown status\n\n**Example Response:**\n```json\n{\n  \"total\": 5,\n  \"active\": 4,\n  \"inactive\": 1,\n  \"healthy\": 3,\n  \"degraded\": 1,\n  \"down\": 1,\n  \"unknown\": 0\n}\n```\n\n**Example Request:**\n```bash\ncurl -H \"Authorization: Bearer YOUR_ADMIN_KEY\" \\\n  https://api.gatewayz.ai/providers/stats\n```",
        "mode": "markdown"
      },
      "pluginVersion": "8.0.0",
      "title": "GET /providers/stats Endpoint",
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 58
      },
      "id": 21,
      "panels": [],
      "title": "Prometheus Metrics Conversion",
      "type": "row"
    },
    {
      "datasource": null,
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 59
      },
      "id": 22,
      "options": {
        "content": "## Metrics Conversion\n\nThe provider-metrics-exporter service converts REST API responses into Prometheus metrics every 60 seconds.\n\n### Aggregate Metrics\n```\ngatewayz_providers_total = 5\ngatewayz_providers_active = 4\ngatewayz_providers_inactive = 1\ngatewayz_providers_healthy = 3\ngatewayz_providers_degraded = 1\ngatewayz_providers_down = 1\ngatewayz_providers_unknown = 0\n```\n\n### Per-Provider Metrics\n```\ngatewayz_provider_response_time_ms{provider=\"openai\"} = 245\ngatewayz_provider_is_active{provider=\"openai\"} = 1\ngatewayz_provider_health_status{provider=\"openai\"} = 1\ngatewayz_provider_supports_streaming{provider=\"openai\"} = 1\ngatewayz_provider_supports_function_calling{provider=\"openai\"} = 1\ngatewayz_provider_supports_vision{provider=\"openai\"} = 1\ngatewayz_provider_supports_image_generation{provider=\"openai\"} = 0\n```\n\n### Health Status Codes\n- `0` = unknown\n- `1` = healthy\n- `2` = degraded\n- `3` = down",
        "mode": "markdown"
      },
      "pluginVersion": "8.0.0",
      "title": "Prometheus Metrics Reference",
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 67
      },
      "id": 23,
      "panels": [],
      "title": "Data Flow & Integration",
      "type": "row"
    },
    {
      "datasource": null,
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 68
      },
      "id": 24,
      "options": {
        "content": "## Data Pipeline\n\n```\nGatewayZ Backend API\n├─ GET /providers (returns array)\n└─ GET /providers/stats (returns stats)\n        ↓\nProvider Metrics Exporter (Railway)\n├─ Fetches every 60 seconds\n├─ Converts JSON to Prometheus metrics\n└─ Exposes on :8001/metrics\n        ↓\nPrometheus (Railway)\n├─ Scrapes metrics every 60 seconds\n├─ Stores in TSDB (15-day retention)\n└─ Exposes metrics API on :9090\n        ↓\nGrafana (Railway)\n├─ Queries Prometheus every 30 seconds\n├─ Visualizes in Provider Management Dashboard\n└─ Displays real-time provider health\n```\n\n## Observability Stack Integration\n\n**Prometheus Configuration:**\n- Job: `provider_metrics`\n- Target: `provider-metrics-exporter:8001`\n- Scrape Interval: 60 seconds\n- Metrics Path: `/metrics`\n\n**Grafana Dashboard:**\n- Name: GatewayZ Provider Management\n- Data Source: Prometheus\n- Refresh Interval: 30 seconds\n- Time Range: Last 6 hours\n\n**Loki Integration (Optional):**\n- Correlate provider metrics with logs\n- Query: `{service=\"provider-metrics-exporter\"}`\n\n**Tempo Integration (Optional):**\n- Trace provider API requests\n- Attributes: service name, HTTP method, status code, duration",
        "mode": "markdown"
      },
      "pluginVersion": "8.0.0",
      "title": "Data Flow Diagram & Integration Details",
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 76
      },
      "id": 25,
      "panels": [],
      "title": "Testing & Troubleshooting",
      "type": "row"
    },
    {
      "datasource": null,
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 0,
        "y": 77
      },
      "id": 26,
      "options": {
        "content": "## Testing Procedures\n\n### Test Backend Connectivity\n```bash\ncurl -H \"Authorization: Bearer YOUR_ADMIN_KEY\" \\\n  https://api.gatewayz.ai/providers/stats\n```\n\n### Test Metrics Exporter\n```bash\ncurl http://provider-metrics-exporter:8001/metrics \\\n  | grep gatewayz_providers\n```\n\n### Test Prometheus Scraping\n```bash\ncurl 'http://prometheus:9090/api/v1/query?query=gatewayz_providers_total'\n```\n\n### Test Grafana Dashboard\n1. Navigate to Grafana\n2. Go to Dashboards → GatewayZ Provider Management\n3. Verify metrics are displayed\n4. Check time range is set correctly\n\n### Verify Prometheus Targets\n1. Go to Prometheus UI → Status → Targets\n2. Look for `provider_metrics` job\n3. Verify health status is \"UP\"\n4. Check last scrape time",
        "mode": "markdown"
      },
      "pluginVersion": "8.0.0",
      "title": "Testing Commands",
      "type": "text"
    },
    {
      "datasource": null,
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 12,
        "y": 77
      },
      "id": 27,
      "options": {
        "content": "## Troubleshooting Guide\n\n### No Data in Dashboard\n1. **Check API connectivity:**\n   ```bash\n   curl -H \"Authorization: Bearer YOUR_ADMIN_KEY\" \\\n     https://api.gatewayz.ai/providers/stats\n   ```\n\n2. **Check exporter logs:**\n   ```bash\n   docker logs provider-metrics-exporter\n   ```\n\n3. **Check Prometheus targets:**\n   - Go to Prometheus UI → Status → Targets\n   - Look for `provider_metrics` job\n   - Verify health status is \"UP\"\n\n4. **Check metrics in Prometheus:**\n   ```bash\n   curl 'http://prometheus:9090/api/v1/query?query=gatewayz_providers_total'\n   ```\n\n### Stale Data\n- Exporter scrape interval: 60 seconds\n- Prometheus scrape interval: 60 seconds\n- Dashboard refresh: 30 seconds\n- Allow 2+ minutes for new data\n\n### Authentication Errors\n- Verify admin key is correct\n- Check key hasn't expired\n- Ensure key has provider management permissions\n\n### Real vs Mock Data\n- **Railway:** Real data from backend API\n- **Local:** Mock data for testing (port 8002)\n- Check environment to verify data source",
        "mode": "markdown"
      },
      "pluginVersion": "8.0.0",
      "title": "Troubleshooting Guide",
      "type": "text"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 27,
  "style": "dark",
  "tags": [
    "providers",
    "management",
    "gatewayz"
  ],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": [
      "5s",
      "10s",
      "30s",
      "1m",
      "5m",
      "15m",
      "30m",
      "1h",
      "2h",
      "1d"
    ]
  },
  "timezone": "",
  "title": "GatewayZ Provider Management",
  "uid": "gatewayz-provider-management",
  "version": 1
}
